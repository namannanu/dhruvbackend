{
  "info": {
    "name": "Team Access Management Testing",
    "description": "Complete test suite for team member access with different permission levels",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000/api/v1"
    },
    {
      "key": "ownerToken",
      "value": "YOUR_BUSINESS_OWNER_JWT_TOKEN"
    },
    {
      "key": "managerToken", 
      "value": "YOUR_MANAGER_JWT_TOKEN"
    },
    {
      "key": "supervisorToken",
      "value": "YOUR_SUPERVISOR_JWT_TOKEN"
    },
    {
      "key": "assistantToken",
      "value": "YOUR_ASSISTANT_JWT_TOKEN"
    },
    {
      "key": "employeeId",
      "value": "EMPLOYEE_MONGODB_OBJECT_ID"
    },
    {
      "key": "employeeEmail",
      "value": "employee@company.com"
    }
  ],
  "item": [
    {
      "name": "Setup - Grant Team Access",
      "item": [
        {
          "name": "Grant Full Access to Manager",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userEmail\": \"manager@company.com\",\n  \"accessLevel\": \"full_access\",\n  \"reason\": \"Manager needs full access to all operations\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/team/grant-access",
              "host": ["{{baseUrl}}"],
              "path": ["team", "grant-access"]
            }
          }
        },
        {
          "name": "Grant Limited Access to Supervisor",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userEmail\": \"supervisor@company.com\",\n  \"accessLevel\": \"manage_operations\",\n  \"permissions\": {\n    \"canViewJobs\": true,\n    \"canEditJobs\": true,\n    \"canViewAttendance\": true,\n    \"canEditAttendance\": true,\n    \"canViewApplications\": true,\n    \"canManageApplications\": true\n  },\n  \"reason\": \"Supervisor needs operational management access\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/team/grant-access",
              "host": ["{{baseUrl}}"],
              "path": ["team", "grant-access"]
            }
          }
        },
        {
          "name": "Grant View Only Access to Assistant",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userEmail\": \"assistant@company.com\",\n  \"accessLevel\": \"view_only\",\n  \"permissions\": {\n    \"canViewJobs\": true,\n    \"canViewAttendance\": true,\n    \"canViewApplications\": true,\n    \"canViewEmployment\": true\n  },\n  \"reason\": \"Assistant needs read-only access for reporting\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/team/grant-access",
              "host": ["{{baseUrl}}"],
              "path": ["team", "grant-access"]
            }
          }
        }
      ]
    },
    {
      "name": "Manager Tests (Full Access)",
      "item": [
        {
          "name": "List All Jobs as Manager",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managerToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/jobs",
              "host": ["{{baseUrl}}"],
              "path": ["jobs"]
            }
          }
        },
        {
          "name": "Create Job as Manager",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managerToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Software Developer\",\n  \"description\": \"Full-stack developer position\",\n  \"location\": \"Remote\",\n  \"salary\": {\n    \"min\": 80000,\n    \"max\": 120000\n  },\n  \"requirements\": [\"JavaScript\", \"Node.js\", \"React\"]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/jobs",
              "host": ["{{baseUrl}}"],
              "path": ["jobs"]
            }
          }
        },
        {
          "name": "View Attendance as Manager",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managerToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/attendance",
              "host": ["{{baseUrl}}"],
              "path": ["attendance"]
            }
          }
        },
        {
          "name": "View Applications as Manager",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managerToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/applications",
              "host": ["{{baseUrl}}"],
              "path": ["applications"]
            }
          }
        }
      ]
    },
    {
      "name": "Supervisor Tests (Limited Access)",
      "item": [
        {
          "name": "List Jobs as Supervisor",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{supervisorToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/jobs",
              "host": ["{{baseUrl}}"],
              "path": ["jobs"]
            }
          }
        },
        {
          "name": "Update Job as Supervisor (Should Work)",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{supervisorToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"description\": \"Updated by supervisor\",\n  \"status\": \"active\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/jobs/{{jobId}}",
              "host": ["{{baseUrl}}"],
              "path": ["jobs", "{{jobId}}"]
            }
          }
        },
        {
          "name": "Create Job as Supervisor (May Fail)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{supervisorToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Test Job by Supervisor\",\n  \"description\": \"This should fail if no create permission\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/jobs",
              "host": ["{{baseUrl}}"],
              "path": ["jobs"]
            }
          }
        },
        {
          "name": "View Attendance as Supervisor",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{supervisorToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/attendance",
              "host": ["{{baseUrl}}"],
              "path": ["attendance"]
            }
          }
        }
      ]
    },
    {
      "name": "Assistant Tests (View Only)",
      "item": [
        {
          "name": "View Jobs as Assistant",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{assistantToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/jobs",
              "host": ["{{baseUrl}}"],
              "path": ["jobs"]
            }
          }
        },
        {
          "name": "Try Create Job as Assistant (Should Fail)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{assistantToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Unauthorized Job Creation\",\n  \"description\": \"This should fail\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/jobs",
              "host": ["{{baseUrl}}"],
              "path": ["jobs"]
            }
          }
        },
        {
          "name": "View Attendance as Assistant",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{assistantToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/attendance",
              "host": ["{{baseUrl}}"],
              "path": ["attendance"]
            }
          }
        },
        {
          "name": "Try Edit Attendance as Assistant (Should Fail)",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{assistantToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"approved\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/attendance/{{attendanceId}}",
              "host": ["{{baseUrl}}"],
              "path": ["attendance", "{{attendanceId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Team Management Tests",
      "item": [
        {
          "name": "Check My Access",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managerToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/team/check-access-by-email/{{employeeEmail}}?permission=canViewJobs",
              "host": ["{{baseUrl}}"],
              "path": ["team", "check-access-by-email", "{{employeeEmail}}"],
              "query": [
                {
                  "key": "permission",
                  "value": "canViewJobs"
                }
              ]
            }
          }
        },
        {
          "name": "List My Managed Access",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{managerToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/team/my-access",
              "host": ["{{baseUrl}}"],
              "path": ["team", "my-access"]
            }
          }
        },
        {
          "name": "Update Team Member Permissions",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"accessLevel\": \"limited_access\",\n  \"permissions\": {\n    \"canCreateJobs\": false,\n    \"canEditJobs\": false,\n    \"canViewJobs\": true,\n    \"canViewAttendance\": true\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/team/access/supervisor@company.com",
              "host": ["{{baseUrl}}"],
              "path": ["team", "access", "supervisor@company.com"]
            }
          }
        },
        {
          "name": "Revoke Team Access",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reason\": \"Access no longer needed\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/team/access/assistant@company.com",
              "host": ["{{baseUrl}}"],
              "path": ["team", "access", "assistant@company.com"]
            }
          }
        }
      ]
    }
  ]
}